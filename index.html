<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>the office in the forest soundscape</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
  :root{
    --bg:#050807;
    --fg:#e7f9ec;
    --accent:#3f8f4b;
    --accent-soft:#214e2a;
  }
  *{ box-sizing:border-box; }
  html,body{
    margin:0;
    padding:0;
    height:100%;
  }
  body{
    background:radial-gradient(circle at top, #102017 0, var(--bg) 55%);
    color:var(--fg);
    font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    display:flex;
    align-items:center;
    justify-content:center;
  }
  .wrap{
    text-align:center;
  }
  button.tree{
    border:none;
    background:var(--accent-soft);
    border-radius:999px;
    padding:18px 26px;
    font-size:3.5rem;
    cursor:pointer;
    box-shadow:0 14px 40px rgba(0,0,0,.55);
    transition:transform .15s ease-out, box-shadow .15s ease-out, background .15s ease-out;
  }
  button.tree:hover{
    transform:translateY(-2px) scale(1.03);
    box-shadow:0 18px 50px rgba(0,0,0,.7);
    background:#266132;
  }
  button.tree:active{
    transform:translateY(1px) scale(0.98);
    box-shadow:0 8px 26px rgba(0,0,0,.6);
  }
  button.tree.playing{
    background:#266132;
    cursor:default;
    box-shadow:0 10px 32px rgba(0,0,0,.6);
  }
  .hint{
    margin-top:10px;
    font-size:.8rem;
    opacity:.5;
  }
</style>


<script src="https://unpkg.com/@strudel/web@latest"></script>
</head>

<body>
<div class="wrap">
  <button class="tree" id="treeBtn" aria-label="Play forest office soundscape">
    ðŸŒ²
  </button>
  <div class="hint">tap the tree to start the forest office</div>
</div>

<script>

  initStrudel();

  const btn = document.getElementById('treeBtn');
  let started = false;

  btn.addEventListener('click', () => {
    if (started) return; 
    started = true;
    btn.classList.add('playing');

    setcpm(70/4);

    const drift = (amt=0.1) => x => x.speed(1 + (Math.random()*amt - amt/2));

    // -------------------------------------------------------------
    //  FOREST
    // -------------------------------------------------------------

    // Wind cycles
    const forestWind =
      s("wind:0*8 wind:1*4 wind:0*6")
        .slow(1.5 + Math.random()/2)
        .gain(0.55 + Math.random()*0.1)
        .room(0.95)
        .size(0.98)
        .cutoff(4000 + Math.random()*2000)
        .off(1/8, drift(0.2));

    // Insects
    const insects =
      s("insect*4 ~ insect*2 ~ insect*6 ~")
        .slow(1.8 + Math.random()*0.6)
        .degradeBy(0.3 + Math.random()*0.4)
        .gain(0.35 + Math.random()*0.1)
        .room(0.9)
        .size(0.95)
        .cutoff(5000)
        .off(1/16, x => x.speed(1.1 + Math.random()*0.3));

    // Deep forest hum
    const forestHum =
      s("space:4 ~ space:2 ~")
        .slow(3 + Math.random())
        .gain(0.3)
        .room(0.8)
        .size(0.9)
        .cutoff(2500 + Math.random()*500)
        .off(1/8, drift(0.05));

    // rare crows
    const distantCrows =
      s("crow ~ ~ ~ ~ ~ ~ ~")
        .slow(6 + Math.random()*4)
        .degradeBy(0.7 + Math.random()*0.3) 
        .gain(0.15 + Math.random()*0.05)
        .room(0.85)
        .cutoff(3000)
        .off(1/16, drift(0.15));

    // -------------------------------------------------------------
    //  office
    // -------------------------------------------------------------

    // Mechanical hum
    const officeMachinery =
      s("0 ~1 ~ ~ ~ 2 ~")
        .bank("xylophone_medium_ff")
        .slow(2 + Math.random()*2)
        .gain(0.04 + Math.random()*0.03)
        .room(0.2)
        .cutoff(1500 + Math.random()*400)
        .degradeBy(0.4 + Math.random()*0.4);

    // Keyboard taps
    const keyboard =
      s("hh hh ~ hh ~ rim ~ hh")
        .bank("AkaiLinn")
        .fast(1.5 + Math.random()*1)
        .degradeBy(0.5 + Math.random()*0.3)
        .gain(0.03 + Math.random()*0.03)
        .room(0.15)
        .cutoff(4500 + Math.random()*600)
        .off(1/8, drift(0.1));

    // Random digital beeps 
    const notifications =
      s("<casio:2 numbers:1 jazz:3> ~ ~ ~")
        .slow(3 + Math.random()*3)
        .degradeBy(0.5 + Math.random()*0.3)
        .gain(0.03 + Math.random()*0.03)
        .room(0.4)
        .size(0.6)
        .cutoff(2000 + Math.random()*400)
        .off(1/16, x => x.speed(1.1 + Math.random()*0.2));

    // Printer swells 
    const printer =
      s("metal:1 ~ space:2 ~")
        .slow(4 + Math.random()*5)
        .degradeBy(0.6 + Math.random()*0.3)
        .gain(0.02 + Math.random()*0.02)
        .room(0.4)
        .cutoff(2000)
        .off(1/16, drift(0.2));

    // -------------------------------------------------------------
    //  MIX
    // -------------------------------------------------------------

    stack(
      forestWind,
      insects,
      forestHum,
      distantCrows,
      officeMachinery,
      keyboard,
      notifications,
      printer
    );
  });
</script>
</body>
</html>
